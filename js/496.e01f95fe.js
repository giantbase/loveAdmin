"use strict";(self["webpackChunklove_admin"]=self["webpackChunklove_admin"]||[]).push([[496],{8496:function(e,t,r){r.r(t),r.d(t,{default:function(){return u}});var a=function(){var e=this,t=e._self._c;return t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{staticStyle:{margin:"20px 0 0 40px"},attrs:{span:23}},[t("el-col",{staticStyle:{"margin-right":"50px"},attrs:{span:12}},[t("div",[t("h2",{staticClass:"titleStyle"},[e._v("活动基础信息")]),t("el-form-item",{attrs:{label:"活动名称：",prop:"name"}},[t("el-input",{attrs:{clearable:""},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),t("el-form-item",{attrs:{label:"活动日期："}},[t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd"},model:{value:e.format.date,callback:function(t){e.$set(e.format,"date",t)},expression:"format.date"}})],1),t("el-form-item",{attrs:{label:"活动时间："}},[t("el-time-picker",{attrs:{"is-range":"","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",placeholder:"选择时间范围"},model:{value:e.format.timeArr,callback:function(t){e.$set(e.format,"timeArr",t)},expression:"format.timeArr"}})],1),t("el-form-item",{attrs:{label:"约发积分数："}},[t("el-input",{attrs:{disabled:""},model:{value:e.ruleForm.integral,callback:function(t){e.$set(e.ruleForm,"integral",t)},expression:"ruleForm.integral"}})],1),t("el-form-item",{attrs:{label:"需要人数：",prop:"needMember"}},[t("el-input-number",{attrs:{min:1,max:100},model:{value:e.ruleForm.needMember,callback:function(t){e.$set(e.ruleForm,"needMember",t)},expression:"ruleForm.needMember"}}),t("span",{staticClass:"tip"},[e._v("(最少1人，最多100人)")])],1),t("el-form-item",{attrs:{label:"活动地址：",prop:"address"}},[t("el-input",{attrs:{clearable:""},model:{value:e.ruleForm.address,callback:function(t){e.$set(e.ruleForm,"address",t)},expression:"ruleForm.address"}})],1),t("el-form-item",{attrs:{label:"活动介绍：",prop:"desp"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},clearable:""},model:{value:e.ruleForm.desp,callback:function(t){e.$set(e.ruleForm,"desp",t)},expression:"ruleForm.desp"}})],1)],1)]),t("el-col",{attrs:{span:10}},[t("div",{staticStyle:{"margin-bottom":"20px"}},[t("h2",{staticClass:"titleStyle"},[e._v("活动图片")]),t("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://101.43.187.111:8082/upload","on-success":e.handleSuccess,headers:e.headerObj,"list-type":"picture","show-file-list":!1,accept:"image/jpeg, image/jpg, image/png"}},[e.ruleForm.imgs[0].imgUrl?t("el-image",{staticClass:"avatar",attrs:{src:e.ruleForm.imgs[0].imgUrl,fit:"cover"}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1),t("span",{staticStyle:{"margin-left":"75px",color:"#606266"}},[e._v("(添加志愿活动图片)")])],1),t("div",[t("h2",{staticClass:"titleStyle"},[e._v("活动联系人")]),t("el-form-item",{attrs:{label:"姓名：",prop:"contactName"}},[t("el-input",{attrs:{clearable:""},model:{value:e.ruleForm.contactName,callback:function(t){e.$set(e.ruleForm,"contactName",t)},expression:"ruleForm.contactName"}})],1),t("el-form-item",{attrs:{label:"手机号：",prop:"contactPhone"}},[t("el-input",{attrs:{clearable:""},model:{value:e.ruleForm.contactPhone,callback:function(t){e.$set(e.ruleForm,"contactPhone",t)},expression:"ruleForm.contactPhone"}})],1)],1)])],1)],1),t("el-row",{staticClass:"subBOX"},[t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("提交活动")]),t("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置表单")])],1)],1)],1)},s=[],l=r(3822),i={name:"NewAcivity",data(){return{pickerOptions:{disabledDate:e=>{}},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:15,message:"活动名称长度在 3 到 15 个字符",trigger:"blur"}],address:[{required:!0,message:"请输入活动详细地址",trigger:"blur"},{min:5,message:"请输入详细地址",trigger:"blur"}],needMember:[{required:!0,message:"请输入活动需要的人数",trigger:"blur"}],contactName:[{required:!0,message:"请输入联系人的姓名",trigger:"blur"},{min:2,message:"请输入正确的姓名",trigger:"blur"}],contactPhone:[{required:!0,message:"请输入联系人的手机号码",trigger:"blur"},{min:11,max:12,message:"请输入正确的手机号码",trigger:"blur"}],desp:[{required:!0,message:"请输入活动的详细介绍",trigger:"blur"},{min:10,message:"活动介绍最少 10 个字符",trigger:"blur"}]},headerObj:{authorization:window.localStorage.getItem("TOKEN")},ruleForm:{address:"",contactName:"",contactPhone:"",createTime:"",desp:"",duration:"",endTime:"",enrollMember:0,id:0,imgUrl:"",imgs:[{imgSort:0,imgUrl:"",isDefault:0,itemId:0}],integral:0,introduction:"",name:"",needMember:0,startTime:"",status:0,teamId:0},format:{date:"",timeArr:""}}},computed:{...(0,l.rn)({member:e=>e.user.member})},methods:{handleSuccess(e){console.log("succuss",e),this.ruleForm.imgs[0].imgUrl=e.data[0],this.$message({message:"活动图片上传成功！",type:"success"})},submitForm(e){this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请检查输入框中的内容是否不符合修改规则！",type:"warning"}),!1;this.format.date&&this.format.timeArr?""==this.ruleForm.imgs[0].imgUrl?this.$message({message:"请检查活动图片是否上传！",type:"warning"}):this.addWishItem(this.ruleForm,this.member.teamId):this.$message({message:"请检查活动日期和活动时间是否输入正确！",type:"warning"})}))},resetForm(e){this.$refs[e].resetFields()},delForm(){this.format.date="",this.format.timeArr="",Object.assign(this.ruleForm,{address:"",contactName:"",contactPhone:"",createTime:"",desp:"",duration:"",endTime:"",enrollMember:0,id:0,imgUrl:"",imgs:[{imgSort:0,imgUrl:"",isDefault:0,itemId:0}],integral:0,introduction:"",name:"",needMember:0,startTime:"",status:0,teamId:0})},async addWishItem(e,t){let r=await this.$http.reqAddWishItem(e,t);0==r.code?(console.log("添加志愿活动",r),this.$message({message:"添加志愿活动成功！",type:"success"}),this.delForm()):this.$message.error(r.msg)}},watch:{format:{deep:!0,handler(e,t){if(e.date&&e.timeArr){let e=new Date(this.format.timeArr[0]),t=new Date(this.format.timeArr[1]);this.ruleForm.startTime=`${this.format.date}T${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}.000+00:00`,this.ruleForm.endTime=`${this.format.date}T${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}:${t.getSeconds().toString().padStart(2,"0")}.000+00:00`;let r=t-e,a=r/36e5;a>=1&&(this.ruleForm.integral=10*Math.floor(a))}}}}},m=i,o=r(1001),n=(0,o.Z)(m,a,s,!1,null,"40dab52c",null),u=n.exports}}]);