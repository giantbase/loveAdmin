"use strict";(self["webpackChunklove_admin"]=self["webpackChunklove_admin"]||[]).push([[855],{8855:function(e,t,a){a.r(t),a.d(t,{default:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("el-row",[t("el-col",{attrs:{span:24}},[t("div",{staticClass:"search"},[t("el-button",{attrs:{type:"danger",disabled:e.disabled},on:{click:function(t){return e.delSelection()}}},[e._v(" 批量删除 ")]),t("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},model:{value:e.searchName,callback:function(t){e.searchName=t},expression:"searchName"}},[t("el-button",{staticClass:"searchInput",attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchInput},slot:"append"},[e._v("搜索")])],1)],1),t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t("el-table-column",{attrs:{label:"编号",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.id))])]}}])}),t("el-table-column",{attrs:{label:"活动名称",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.name))])]}}])}),t("el-table-column",{attrs:{label:"活动开始时间",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(e._f("timeFilter")(a.row.startTime)))])]}}])}),t("el-table-column",{attrs:{label:"活动结束时间",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(e._f("timeFilter")(a.row.endTime)))])]}}])}),t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-badge",{staticClass:"item",attrs:{"is-dot":!a.row.isProcess}},[t("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return e.handleDetails(a.$index,a.row)}}},[e._v(" 查看详情 ")])],1),t("el-button",{staticStyle:{margin:"5px 0 5px 10px"},attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.deleteRow(a.$index,e.tableData)}}},[e._v(" 删除 ")])]}}])})],1),e.drawer?t("el-drawer",{staticClass:"drawer",attrs:{title:"活动详情",visible:e.drawer},on:{"update:visible":function(t){e.drawer=t}}},[t("div",{staticClass:"checkVolTime"},[t("el-badge",{attrs:{value:e.drawerData.unProcessMemberItemVoList.records.length}},[t("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(t){e.dialogTableCheckVisible=!0}}},[e._v("未审核")]),t("el-dialog",{attrs:{title:"审核志愿者服务时长",visible:e.dialogTableCheckVisible,"append-to-body":!0,width:"900px"},on:{"update:visible":function(t){e.dialogTableCheckVisible=t}}},[t("el-button",{staticStyle:{margin:"-10px 0 10px"},attrs:{type:"warning",disabled:e.disabledCheck},on:{click:function(t){return e.proSelection()}}},[e._v(" 批量审核 ")]),t("el-table",{attrs:{data:e.drawerData.unProcessMemberItemVoList.records,stripe:"",border:"","max-height":"400"},on:{"selection-change":e.checkChange}},[t("el-dialog",{attrs:{title:"审核信息",visible:e.dialogiIsProcessVisible,width:"30%","append-to-body":""},on:{"update:visible":function(t){e.dialogiIsProcessVisible=t}}},[t("el-radio",{attrs:{label:"1"},model:{value:e.processStatus,callback:function(t){e.processStatus=t},expression:"processStatus"}},[e._v("审核通过")]),t("el-radio",{attrs:{label:"2"},model:{value:e.processStatus,callback:function(t){e.processStatus=t},expression:"processStatus"}},[e._v("审核不通过")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogiIsProcessVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.dialogSub}},[e._v("确 定")])],1)],1),t("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),t("el-table-column",{attrs:{property:"id",label:"编号",width:"70",align:"center"}}),t("el-table-column",{attrs:{property:"username",label:"姓名",width:"150",align:"center"}}),t("el-table-column",{attrs:{property:"signInTime",label:"签到时间",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(e._f("timeFilter")(a.row.signInTime)))])]}}],null,!1,296529771)}),t("el-table-column",{attrs:{property:"signOutTime",label:"签退时间",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(e._f("timeFilter")(a.row.signOutTime)))])]}}],null,!1,3483707810)}),t("el-table-column",{attrs:{property:"workTime",label:"服务时长",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(e._f("timestamp")(a.row.workTime)))])]}}],null,!1,3247471493)})],1)],1)],1),t("el-badge",{attrs:{value:e.drawerData.allJoinWishItemMember.records.length}},[t("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){e.dialogTableVisible=!0}}},[e._v("已审核")]),t("el-dialog",{attrs:{title:"服务时长通过审核名单",visible:e.dialogTableVisible,"append-to-body":!0,width:"850px"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[t("el-table",{attrs:{data:e.drawerData.allJoinWishItemMember.records,stripe:"",border:"","max-height":"400"}},[t("el-table-column",{attrs:{property:"id",label:"编号",width:"70",align:"center"}}),t("el-table-column",{attrs:{property:"username",label:"姓名",width:"150",align:"center"}}),t("el-table-column",{attrs:{property:"signInTime",label:"签到时间",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(e._f("timeFilter")(a.row.signInTime)))])]}}],null,!1,296529771)}),t("el-table-column",{attrs:{property:"signOutTime",label:"签退时间",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(e._f("timeFilter")(a.row.signOutTime)))])]}}],null,!1,3483707810)}),t("el-table-column",{attrs:{property:"workTime",label:"服务时长",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(e._f("timestamp")(a.row.workTime)))])]}}],null,!1,3247471493)})],1)],1)],1)],1),t("div",[t("h2",{staticClass:"drawerTitle"},[e._v("活动图片及所需人数")]),t("div",{staticClass:"popoverHover flexDetails"},[t("el-popover",{attrs:{placement:"left",width:"350",trigger:"click"}},[e.drawerData.imgUrls?t("el-image",{staticStyle:{width:"100%"},attrs:{fit:"cover",src:e.drawerData.imgUrls[0].imgUrl}}):e._e(),t("el-image",{staticStyle:{width:"200px"},attrs:{slot:"reference",fit:"cover",src:e.drawerData.imgUrls[0].imgUrl},slot:"reference"},[t("div",{staticClass:"image-slot",staticStyle:{margin:"17px 0",color:"#c0c4cc"},attrs:{slot:"error"},slot:"error"},[e._v(" 图片加载失败 ")])])],1),t("div",[t("span",[e._v("活动规模："),t("i",[e._v(e._s(e.drawerData.needMember))])]),t("span",[e._v("已招人数："),t("i",[e._v(e._s(e.drawerData.enrollMember))])]),t("span",[e._v(" 可获得积分："),t("i",[e._v(e._s(e.drawerData.integral))])])])],1)]),t("div",[t("h2",{staticClass:"drawerTitle"},[e._v("活动详情")]),t("div",{staticClass:"popoverHover"},[t("span",{staticStyle:{"margin-right":"40px"}},[e._v(" id："),t("i",[e._v(e._s(e.drawerData.id))])]),t("span",[e._v(" 活动名："),t("i",[e._v(e._s(e.drawerData.name))])]),t("div",{staticStyle:{margin:"10px 0"}},[e._v(" 所属服务队："),t("i",[e._v(e._s(e.drawerData.teamName))])]),t("div",[e._v(" 服务队地址："),t("i",[e._v(e._s(e.drawerData.teamAddress))])])])]),t("div",[t("h2",{staticClass:"drawerTitle"},[e._v("负责人信息")]),t("div",{staticClass:"popoverHover"},[t("span",{staticStyle:{"margin-right":"40px"}},[e._v(" 姓名："),t("i",[e._v(e._s(e.drawerData.contactName))])]),t("span",[e._v(" 电话："),t("i",[e._v(e._s(e.drawerData.contactPhone))])])])]),t("div",[t("h2",{staticClass:"drawerTitle"},[e._v("活动地址和创建时间")]),t("div",{staticClass:"popoverHover"},[t("div",[e._v(" 地址："),t("i",[e._v(e._s(e.drawerData.address))])]),t("div",{staticStyle:{margin:"10px 0"}},[e._v(" 开始时间："),t("i",[e._v(e._s(e._f("timeFilter")(e.drawerData.startTime)))])]),t("div",[e._v(" 结束时间："),t("i",[e._v(e._s(e._f("timeFilter")(e.drawerData.endTime)))])])])]),t("div",[t("h2",{staticClass:"drawerTitle"},[e._v("活动介绍")]),t("div",{staticClass:"popoverHover"},[t("span",[t("i",[e._v(e._s(e.drawerData.desp))])])])])]):e._e(),t("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{background:"","current-page":e.currentPage,"page-size":e.size,"pager-count":5,layout:"prev, pager, next, jumper, total",total:e.total},on:{"current-change":e.getAllFinishItem}})],1)],1)},i=[],l=a(3822),r={name:"EndItem",data(){return{searchName:"",deleteData:[],disabled:!0,tableData:[],currentPage:1,size:8,total:0,drawer:!1,drawerData:{},dialogTableVisible:!1,dialogTableCheckVisible:!1,disabledCheck:!0,dialogiIsProcessVisible:!1,processStatus:"",processData:[]}},mounted(){this.getAllFinishItem()},computed:{...(0,l.rn)({member:e=>e.user.member})},methods:{handleDetails(e,t){this.getWishItemDetail(t.id)},deleteRow(e,t){this.$confirm("此操作将永久删除该志愿活动, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.deleteWishItem(t[e].id),this.$message({type:"success",message:"删除成功!"}),setTimeout((()=>{this.getAllFinishItem()}),500)})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},handleSelectionChange(e){this.deleteData=e},delSelection(){this.$confirm("此操作将永久删除志愿活动, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{if(0!=this.deleteData.length)for(let e=0;e<this.deleteData.length;e++)this.deleteWishItem(this.deleteData[e].id);this.$message({type:"success",message:"删除成功!"}),setTimeout((()=>{this.getAllFinishItem()}),500)})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},proSelection(){this.dialogiIsProcessVisible=!0},checkChange(e){this.processData=e},dialogSub(){if(""!=this.processStatus){if(0!=this.processData.length)for(let e=0;e<this.processData.length;e++)this.processMemberItems(this.processData[e].id,this.processStatus);this.dialogiIsProcessVisible=!1,this.dialogTableCheckVisible=!1,this.drawer=!1,this.$message({type:"success",message:"提交成功!"}),setTimeout((()=>{this.getAllFinishItem()}),500)}else this.$message({type:"warning",message:"请先进行申请审核再进行提交!"})},searchInput(){this.selectFinishWishItemByName(this.searchName,this.member.teamId)},async getAllFinishItem(e=1){this.currentPage=e;let t=await this.$http.reqGetAllFinishItem(this.currentPage,this.size,this.member.teamId);console.log("查询志愿服务队已结束志愿活动",t),0==t.code?(this.total=t.data.total,this.tableData=t.data.records):500==t.code?this.$message.error(t.msg):this.$message({message:t.msg,type:"warning"})},async getWishItemDetail(e){let t=1,a=100,s=await this.$http.reqGetWishItemDetail(t,a,e);0==s.code?(console.log("查询志愿活动详情",s),this.drawerData=s.data,this.drawer=!0):this.$message.error(s.msg)},async deleteWishItem(e){let t=await this.$http.reqDeleteWishItem(e);0==t.code?console.log("删除志愿活动",t):this.$message.error(t.msg)},async selectFinishWishItemByName(e,t){let a=1,s=100,i=await this.$http.reqSelectFinishWishItemByName(e,a,s,t);0==i.code?(console.log("根据志愿活动名称搜索已结束的志愿服务活动",i),this.total=i.data.total,this.tableData=i.data.records):this.$message.error(i.msg)},async processMemberItems(e,t){let a=await this.$http.reqProcessMemberItems(e,t);0==a.code?console.log("审核志愿服务活动记录",a):this.$message.error(a.msg)}},watch:{deleteData:{immediate:!0,handler(e,t){0!=e.length?this.disabled=!1:this.disabled=!0}},processData:{immediate:!0,handler(e,t){0!=e.length?this.disabledCheck=!1:this.disabledCheck=!0}},searchName(e,t){""==e&&this.getAllFinishItem()}},filters:{timeFilter(e){if(void 0!=e)return`${e.split("T")[0]} ${e.split("T")[1].split(".")[0]}`},timestamp(e){if(void 0!=e){if(0==e)return"0 小时";const t=Math.floor(e/36e5),a=Math.floor(e%36e5/6e4),s=Math.floor(e%6e4/1e3);let i="";return t>0&&(i+=t+"时"),a>0&&(i+=a+"分"),s>0&&(i+=s+"秒"),i}}}},n=r,o=a(1001),c=(0,o.Z)(n,s,i,!1,null,"4f8d03c8",null),d=c.exports}}]);